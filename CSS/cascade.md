# 层叠 Cascade #
  
样式表可以有不同的来源：作者、用户、用户代理。  
* *author*: 作者指定一个源文档的样式表。  
* *user*: 用户可以为特定的文档指定样式信息。  
* *user agent*: 用户代理必须有一个默认的样式信息或行为。  

> 用户可以修改系统设置，而这有可能会影响默认的样式表。有一些用户代理实现可以去改变默认样式表中的值。  

来源不同的样式表可能会重叠，而这种交互就由**层叠**决定。*CSS*层叠给每条*style rule*赋予一个权值。当有规则冲突时，则权值最大的那条胜出。  
  
一般情况：  
1. 默认，*author*样式表的权值比*user*样式表的权值大，  
2. 在有*! important*的情况下，1 的情况颠倒，  
3. *user, author*的样式表的权值都比*US*样式表的权值大。  

## 层叠顺序 ##
  
得出一个元素的属性值，用户代理必须依照如下顺序：  
1. 找出所有应用到该元素的声明，  
2. 依据重要性和来源排序。升序为：  
	1. 用户代理声明，  
	2. 用户一般声明，  
	3. 作者一般声明，  
	4. 作者重要声明，  
	5. 用户重要声明。  
3. 对重要性和来源相同的规则，按照选择器的**特殊性**排序。特殊性高的选择器会覆盖特殊性一般的选择器。伪元素和伪类的特殊性计算分别按一般的元素和类的特殊性值计算，  
4. 最后，按指定的顺序排序。如果两个规则有相同的权值，来源和特殊性值，则后声明的规则胜出。声明在导入的样式表中的规则都被认为在该样式表文件中声明的规则之前。   

## !important 规则 ##
  
这是为了在用户样式和作者样式之间创造平衡。  
把一个缩写的属性声明为*!important*等同于把其所有子属性声明为*!important*。  
  
## 选择器特殊性 ##
  
选择器的特殊性计算，如下：  
特殊性值初始为 `a = 0, b = 0, c = 0, d = 0`,  
1. 在`style`属性中声明而不是通过选择器在规则中声明的，`a = 1`,其余的` a = 0`,  
2. 选择器中*ID*属性的数目 ` = b`,  
3. 选择器中其他属性和伪类的数目 `= c`,  
4. 选择器中元素名和伪4元素的数目 `= d`。  

特殊性值仅仅只与选择器的形式有关。特别的，一个行如`[id=123]`的选择器4被认为是属性选择器，特殊性值为`c=1`.  
`*`的特殊性值为 `0,0,0,0`。